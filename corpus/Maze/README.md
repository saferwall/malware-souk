# Maze

* First seen: May 2019
* Aliases: ChaCha
* Samples:
    - 24da3ccf131b8236d3c4a8cc29482709531232ef9c9cba38266b908439dea063 | windows | ransom | pe
    - fc611f9d09f645f31c4a77a27b6e6b1aec74db916d0712bef5bce052d12c971f | windows | exploit | pe
    - 953d574ef0f49e886e270c2887586aab5c0d37616dd99f422838a1257abdbe3b | windows | exploit | pe
    - 987bec3c79c8d19cfa4ec66e8e05ab8ccd8700f9d22083c9e61f596451e8f4d2 | windows | exploit | shellcode

##  Maze Windows Payload
### Basic Properties

| Property | Value |
| --- | --- |
| Size | 372736 bytes |
| CRC32 | 0x4e4ad45e |
| MD5 | 064058cf092063a5b69ed8fd2a1a04fe |
| SHA1 | 92b44e52f13bcb097f412a6a61bdc46ac19584c6 |
| SHA256 | 24da3ccf131b8236d3c4a8cc29482709531232ef9c9cba38266b908439dea063 |
| SHA512 | 19ed838eadbd23c17ec751cb4ed03059629f3fc64bc6225d23dc471a7c5b4d6223b9f27e5942a3dcff8776eef9b573bceb7748596d1715aaa23dbb614201e2af |
| Ssdeep | 6144:Sx0s5c9jrLrLrLZMEQ9V6wZqEZw0eNsd198V50DErNNg/ydlb4fQ6wFMvM:mMAwmlDYNg6dNoQl&#43;v |
| Magic | PE32 executable (GUI) Intel 80386, for MS Windows  |
| Packer | PE: linker: Microsoft Linker(12.0)[EXE32]<br /> |
| TrID | 44.6% (.EXE) Win32 Executable MS Visual C&#43;&#43; (generic) (31206/45/13)<br />23.6% (.EXE) Microsoft Visual C&#43;&#43; compiled executable (generic) (16529/12/5)<br />9.4% (.DLL) Win32 Dynamic Link Library (generic) (6578/25/2)<br />7.2% (.EXE) Win16 NE executable (generic) (5038/12/1)<br />6.4% (.EXE) Win32 Executable (generic) (4505/5/1)<br /> |

## Antivirus Scan

```diff
- Avast: Win32:RansomX-gen [Ransom]
- Avira: TR/Redcap.zlqca
- Bitdefender: Generic.Ransom.Maze.Packed.4CD9E4BC
- Clamav: Win.Malware.Agent-7761376-0
- Comodo: TrojWare.Win32.Trojan.hrup.~GEN
- Drweb: Trojan.Encoder.28416
- Eset: Win32/Filecoder.Maze.B
- Fsecure: Trojan.TR/Redcap.zlqca
- Kaspersky: HEUR:Trojan.Win32.Generic
+ Mcafee: clean
- Sophos: Troj/Maze-O
- Symantec: Ransom.Maze
- Trendmicro: Ransom.Win32.MAZE.SMDA
- Windefender: Ransom:Win32/Maze.PA!MTB
```

##  Maze 32-bit exploit dll [CVE-2016-7255]
### Basic Properties

| Property | Value |
| --- | --- |
| Size | 518656 bytes |
| CRC32 | 0xd385327b |
| MD5 | e69a8eb94f65480980deaf1ff5a431a6 |
| SHA1 | dcd2ab4540bde88f58dec8e8c243e303ec4bdd87 |
| SHA256 | fc611f9d09f645f31c4a77a27b6e6b1aec74db916d0712bef5bce052d12c971f |
| SHA512 | 3338e225d51efef723a520f52385f01b590638a4da7ccf56b52f59f2cfc169cba8b2f0328d90a1a38eaaeb3074c54d0dd1f82ae7f2bd1b5658a4899a0f93a9d2 |
| Ssdeep | 6144:3iGYr8QYvhH/Ihfkt8Rr0Mw6UI7ITQhG4GTnNVzQD5RYGOomKkv5V6ZRIT9ZrcO:nQD5RYGOuGLORICLSjRer5x2x8OSZM&#43; |
| Magic | PE32 executable (GUI) Intel 80386, for MS Windows  |
| Packer | PE: compiler: Microsoft Visual C/C&#43;&#43;(2013)[-]<br />PE: linker: Microsoft Linker(12.0)[EXE32]<br /> |
| TrID | 48.8% (.EXE) Win32 Executable MS Visual C&#43;&#43; (generic) (31206/45/13)<br />16.4% (.EXE) Win64 Executable (generic) (10523/12/4)<br />10.2% (.DLL) Win32 Dynamic Link Library (generic) (6578/25/2)<br />7.8% (.EXE) Win16 NE executable (generic) (5038/12/1)<br />7.0% (.EXE) Win32 Executable (generic) (4505/5/1)<br /> |

## Antivirus Scan

```diff
- Avast: Win32:RansomX-gen [Ransom]
- Avira: TR/FileCoder.mcfkq
- Bitdefender: Trojan.GenericKD.32602035
- Clamav: Win.Ransomware.Packer-7473772-1
- Comodo: Application.Win32.Dlhelper.GJ
- Drweb: Trojan.Encoder.29834
- Eset: Win32/Filecoder.Maze.A
- Fsecure: Trojan.TR/FileCoder.mcfkq
- Kaspersky: Trojan-Ransom.Win32.Maze.dz
+ Mcafee: clean
- Sophos: Troj/Ransom-FXG
- Symantec: Trojan.Gen.2
- Trendmicro: Ransom.Win32.MAZE.THKBIAI
- Windefender: Ransom:Win32/Genasom!MTB
```

##  Maze 64-bit exploit dll [CVE-2016-7255]
### Basic Properties

| Property | Value |
| --- | --- |
| Size | 11264 bytes |
| CRC32 | 0x7c4bc191 |
| MD5 | 79abd17391adc6251ecdc58d13d76baf |
| SHA1 | 60a7d39dca41e0cc4d7fed495cd4ce6db9e966db |
| SHA256 | 953d574ef0f49e886e270c2887586aab5c0d37616dd99f422838a1257abdbe3b |
| SHA512 | fc99030cdc615275ab8222341bfe6a83f885f65feb9f372c956424a1338fcc034e644d25b0069c6345810c5811e5b8078fdb4ccb43eea5727b675969d6907aee |
| Ssdeep | 192:1ixjQPreeX0x7eJmuWCuf9X9/O/900VlDNCY0h/mcblRsOqvZ&#43;uy:cxjQT3XEuWC29X9/FC4BRsXvAu |
| Magic | PE32 executable (DLL) (GUI) Intel 80386, for MS Windows  |
| Packer | PE: patcher: simple patch(-)[-]<br />PE: compiler: Microsoft Visual C/C&#43;&#43;(2005)[-]<br />PE: linker: Microsoft Linker(8.0 or 11.0)[DLL32]<br /> |
| TrID | 29.6% (.DLL) Win32 Dynamic Link Library (generic) (6578/25/2)<br />22.7% (.EXE) Win16 NE executable (generic) (5038/12/1)<br />20.3% (.EXE) Win32 Executable (generic) (4505/5/1)<br />9.1% (.EXE) OS/2 Executable (generic) (2029/13)<br />9.0% (.EXE) Generic Win/DOS Executable (2002/3)<br /> |

## Antivirus Scan

```diff
- Avast: Win32:Malware-gen
+ Avira: clean
- Bitdefender: Gen:Variant.Ursu.412913
+ Clamav: clean
- Comodo: Malware
- Drweb: Exploit.CVE-2016-7255.2
+ Eset: clean
- Fsecure: Heuristic.HEUR/AGEN.1240239
- Kaspersky: HEUR:Trojan.Win32.Generic
- Mcafee: Exploit-CVE2016-7255
- Sophos: Troj/Agent-BEGZ
- Symantec: Trojan Horse
+ Trendmicro: clean
+ Windefender: clean
```

##  Maze exploit shellcode [CVE-2018-8453]
### Basic Properties

| Property | Value |
| --- | --- |
| Size | 38400 bytes |
| CRC32 | 0xd2d6e651 |
| MD5 | 443f39b28a5b2434f1985f2fc43dc034 |
| SHA1 | 2d39c859af9d8cd7ee04d01c0fb3847ab23c5732 |
| SHA256 | 987bec3c79c8d19cfa4ec66e8e05ab8ccd8700f9d22083c9e61f596451e8f4d2 |
| SHA512 | a1a9381d51d8181d7a67a1c7155ded0e3f3cd50cd3d4ac8550bd917ffa7aa622b5b6cd3349cdc0df77c0f6ffb24ec4211ee35f1fdec893034389c2bf9d3b260e |
| Ssdeep | 768:QPPmR9M4PV1KfYUCq6GNo4578lJ2jPHVCgjODkbt1tSi&#43;:Q7Pbi4eTMlux |
| Magic | data  |
| Packer | Binary: Nothing found<br /> |
| TrID | Unknown!<br /> |

## Antivirus Scan

```diff
- Avast: Win32:CVE-2018-8453-M [Expl]
+ Avira: clean
+ Bitdefender: clean
+ Clamav: clean
+ Comodo: clean
+ Drweb: clean
+ Eset: clean
+ Fsecure: clean
+ Kaspersky: clean
+ Mcafee: clean
+ Sophos: clean
- Symantec: Downloader
+ Trendmicro: clean
+ Windefender: clean
```

## References
- [https://www.crowdstrike.com/blog/maze-ransomware-analysis-and-protection/](https://www.crowdstrike.com/blog/maze-ransomware-analysis-and-protection/)
- [https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ransomware-maze/](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/ransomware-maze/)
- [https://www.mandiant.com/resources/blog/tactics-techniques-procedures-associated-with-maze-ransomware-incidents](https://www.mandiant.com/resources/blog/tactics-techniques-procedures-associated-with-maze-ransomware-incidents)
- [https://www.bleepingcomputer.com/news/security/ransomware-dev-releases-egregor-maze-master-decryption-keys/](https://www.bleepingcomputer.com/news/security/ransomware-dev-releases-egregor-maze-master-decryption-keys/)
- [https://securityaffairs.co/wordpress/127826/malware/egregor-sekhmet-decryption-keys.html](https://securityaffairs.co/wordpress/127826/malware/egregor-sekhmet-decryption-keys.html)
- [https://s3.amazonaws.com/talos-intelligence-site/production/document_files/files/000/095/543/original/CTIR_casestudy_1.pdf](https://s3.amazonaws.com/talos-intelligence-site/production/document_files/files/000/095/543/original/CTIR_casestudy_1.pdf)
- [https://blogs.quickheal.com/maze-ransomware-continues-threat-consumers/](https://blogs.quickheal.com/maze-ransomware-continues-threat-consumers/)
- [https://www.sentinelone.com/labs/enter-the-maze-demystifying-an-affiliate-involved-in-maze-snow/](https://www.sentinelone.com/labs/enter-the-maze-demystifying-an-affiliate-involved-in-maze-snow/)
- [https://www.sentinelone.com/labs/case-study-catching-a-human-operated-maze-ransomware-attack-in-action/](https://www.sentinelone.com/labs/case-study-catching-a-human-operated-maze-ransomware-attack-in-action/)
- [https://securelist.com/maze-ransomware/99137/](https://securelist.com/maze-ransomware/99137/)
- [https://www.crowdstrike.com/blog/maze-ransomware-deobfuscation/](https://www.crowdstrike.com/blog/maze-ransomware-deobfuscation/)
- [https://www.docdroid.net/dUpPY5s/maze-pdf](https://www.docdroid.net/dUpPY5s/maze-pdf)
