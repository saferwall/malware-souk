# Babuk

* First seen: January 2021
* Aliases:Babyk
* Samples:
    - 391cfcd153881743556f76de7bbca5b19857f8b69a6f6f6dfde6fd9b06c17f5e | windows | ransom | pe
    - e8cee8eab4020e1aadd4631ed626ab54d8733f8b14d683ca943cd4e124eeef55 | linux | ransom | elf
    - 51fe57795105eb1e618d35bd99fcc096ee3687455cd4e330396c0d701bc3a6a1 | linux | ransom | elf
    - dc90560d7198bf824b65ba2cfbe403d84d38113f41a1aa2f37f8d827fd9e0ceb | linux | ransom | elf

##  Babuk Windows Payload
### Basic Properties

| Property | Value |
| --- | --- |
| Size | 76800 bytes |
| CRC32 | 0x69c48274 |
| MD5 | 98b04a1cfdf18674315ec137733553a7 |
| SHA1 | dd1cdb8782b5e08695b006393d1e8ab4e447556e |
| SHA256 | 391cfcd153881743556f76de7bbca5b19857f8b69a6f6f6dfde6fd9b06c17f5e |
| SHA512 | 3c5d9884a922b4b974c3dbd0e6f73292b7bfa761a1e50cfb1af07752261cf1a8ea2520a13f28f7040d788bff3837c62c7a6595f03b1c1be5f8d4ea9848f09cb5 |
| Ssdeep | 1536:Bb6MM2qw/ZhutMC1u2srQLOJgY8ZZP8LHD4XWaNH71dLdG1iiFM2iG2Lr:VM2qaZ2i2srQLOJgY8Zp8LHD4XWaNH7 |
| Magic | PE32 executable (GUI) Intel 80386, for MS Windows  |
| Packer | PE: linker: Microsoft Linker(14.27**)[EXE32]<br /> |
| TrID | 58.4% (.EXE) Win32 Executable MS Visual C&#43;&#43; (generic) (31206/45/13)<br />12.3% (.DLL) Win32 Dynamic Link Library (generic) (6578/25/2)<br />9.4% (.EXE) Win16 NE executable (generic) (5038/12/1)<br />8.4% (.EXE) Win32 Executable (generic) (4505/5/1)<br />3.8% (.EXE) OS/2 Executable (generic) (2029/13)<br /> |

## Antivirus Scan

```diff
- Avast: Win32:RansomX-gen [Ransom]
+ Avira: clean
- Bitdefender: Trojan.Ransom.Babuk.C
- Clamav: Win.Ransomware.Packer-7473772-1
- Comodo: Malware
- Drweb: Trojan.Encoder.34363
- Eset: Win32/Filecoder.Babyk.A
- Fsecure: Heuristic.HEUR/AGEN.1234183
- Kaspersky: HEUR:Trojan.Win32.Generic
+ Mcafee: clean
- Sophos: Troj/Ransom-GEY
- Symantec: Ransom.Babuk
- Trendmicro: Ransom.Win32.BABUKLOCKER.SM
- Windefender: Ransom:Win32/Babuk.MAK!MTB
```

##  Babuk NAS ARM Payload
### Basic Properties

| Property | Value |
| --- | --- |
| Size | 2220401 bytes |
| CRC32 | 0xbf39357 |
| MD5 | 28249fc247a858d9727c860e4a484392 |
| SHA1 | 37b2ee4c3f6b9976e2335421a05e4b480c09ff9d |
| SHA256 | e8cee8eab4020e1aadd4631ed626ab54d8733f8b14d683ca943cd4e124eeef55 |
| SHA512 | af4109064b524761fc3b0b5b27ab634e9eda7c8897fe5fb5b2d39dd1b620a402eb97ce5e76d99f9a959c2c6a162a2037c398c2181d2f66d029b46d73ec7f43e4 |
| Ssdeep | 49152:RJZuecSwpeH2LTBnW01NEXTY4TumnwM7UB3:nZueanLjSumnJ70 |
| Magic | ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), statically linked, not stripped  |
| Packer | ELF: Nothing found<br /> |
| TrID | 50.1% (.) ELF Executable and Linkable format (Linux) (4022/12)<br />49.8% (.O) ELF Executable and Linkable format (generic) (4000/1)<br /> |

## Antivirus Scan

```diff
- Avast: ELF:Filecoder-BQ [Trj]
- Avira: Linux/Encoder.gedwg
- Bitdefender: Trojan.Agent.Babyk.A
- Clamav: Unix.Ransomware.Babuk-9875166-1
+ Comodo: clean
- Drweb: Linux.Encoder.91
- Eset: Linux/Filecoder.Babyk.B
- Fsecure: Malware.LINUX/Encoder.gedwg
- Kaspersky: HEUR:Trojan-Ransom.Linux.Babuk.a
- Mcafee: Ransom-Babuk
- Sophos: Linux/Ransm-L
- Symantec: Trojan.Gen.NPE
- Trendmicro: Ransom.Linux.BABUK.A
- Windefender: Ransom:Linux/BabukCrypt.PB!MTB
```

##  Babuk NAS x86 Payload
### Basic Properties

| Property | Value |
| --- | --- |
| Size | 2031830 bytes |
| CRC32 | 0x8ab534f2 |
| MD5 | 29efe5693da727cdca8c637d343b07cd |
| SHA1 | a5ee4e8a413ea03639721f31de5f42d4b0968039 |
| SHA256 | 51fe57795105eb1e618d35bd99fcc096ee3687455cd4e330396c0d701bc3a6a1 |
| SHA512 | 5f19057919b4018114fcb58e0d848960acbf26d461077a85a935b64e7ec161f45047e6dc6c4664058b36902bc39b297c292eb8af2557dddd5bbdfdc975e6f377 |
| Ssdeep | 49152:Emsq5TJqKK8XhjTyUCWU1pWmUYkfhtpmXNb:EmswTJqURIUtfhtoB |
| Magic | ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, not stripped  |
| Packer | ELF: Nothing found<br /> |
| TrID | 50.1% (.) ELF Executable and Linkable format (Linux) (4022/12)<br />49.8% (.O) ELF Executable and Linkable format (generic) (4000/1)<br /> |

## Antivirus Scan

```diff
- Avast: ELF:Filecoder-CU [Trj]
- Avira: Linux/Encoder.lwzsb
- Bitdefender: Trojan.Linux.Babuk.D
- Clamav: Unix.Ransomware.Babuk-9875166-1
+ Comodo: clean
- Drweb: Linux.Encoder.89
+ Eset: clean
- Fsecure: Malware.LINUX/Encoder.lwzsb
+ Kaspersky: clean
- Mcafee: Ransom-Babuk
+ Sophos: clean
+ Symantec: clean
- Trendmicro: PUA.Linux.BABUK.B.decryptor
- Windefender: Ransom:Linux/Babuk.D!MTB
```

##  Babuk ESXi Payload
### Basic Properties

| Property | Value |
| --- | --- |
| Size | 70720 bytes |
| CRC32 | 0x8a413093 |
| MD5 | ce73b00417464190d7fb9b36af74968a |
| SHA1 | 885a734c7869b52aa125674cb430199b2645cda0 |
| SHA256 | dc90560d7198bf824b65ba2cfbe403d84d38113f41a1aa2f37f8d827fd9e0ceb |
| SHA512 | 7710eb3c601f0b6066606f7a098811efa8e411b12164e7bcb2ab289920156367ee53e6c243937d89ccf17af9c207856fbd2f125982e5242938cd189965a3556d |
| Ssdeep | 1536:OgsIH3ny6nOyCNTs0BMScQLBrdE2TUwELzzhZaBHU2eQP:OgLXy6pCNLpcQLBrjTqloOw |
| Magic | ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.18, BuildID[sha1]=66fc99c8a97d44e0f14f86dfa915776fab535f47, stripped  |
| Packer | ELF64: library: GLIBC(2.3.2)[executable AMD64-64]<br />ELF64: compiler: gcc((GNU) 4.4.7 20120313 (Red Hat 4.4.7-23))[executable AMD64-64]<br /> |
| TrID | 50.1% (.) ELF Executable and Linkable format (Linux) (4022/12)<br />49.8% (.O) ELF Executable and Linkable format (generic) (4000/1)<br /> |

## Antivirus Scan

```diff
- Avast: ELF:Filecoder-BO [Trj]
- Avira: Linux/Encoder.tovmu
- Bitdefender: Trojan.Agent.Babyk.A
- Clamav: Unix.Ransomware.Babuk-9875166-1
+ Comodo: clean
- Drweb: Linux.Encoder.90
- Eset: Linux/Filecoder.Babyk.A
- Fsecure: Malware.LINUX/Encoder.tovmu
- Kaspersky: HEUR:Trojan-Ransom.Linux.Babuk.b
+ Mcafee: clean
+ Sophos: clean
- Symantec: Ransom.Babuk
- Trendmicro: Ransom.Linux.BABUK.YXBF4
- Windefender: Ransom:MacOS/Filecoder
```

## References
- [https://blog.cyble.com/2021/07/05/deep-dive-into-builder-of-notorious-babuk-ransomware/](https://blog.cyble.com/2021/07/05/deep-dive-into-builder-of-notorious-babuk-ransomware/)
- [https://www.mcafee.com/enterprise/en-us/assets/reports/rp-babuk-moving-to-vm-nix-systems.pdf](https://www.mcafee.com/enterprise/en-us/assets/reports/rp-babuk-moving-to-vm-nix-systems.pdf)
- [https://chuongdong.com/reverse%20engineering/2021/01/03/BabukRansomware/](https://chuongdong.com/reverse%20engineering/2021/01/03/BabukRansomware/)
